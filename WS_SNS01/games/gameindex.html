<?php

require_once '../header.php';

if (!$loggedIn)
{
	echo "<link rel='stylesheet' href='../styles.css' type='text/css'>";
	//echo "<script src='headerLinkMod.js'></script>";
	echo <<<_END
	<script>
		$("#HomeLink2").prop("href", "../index.php");
		$("#SignupLink").prop("href", "../signup.php");
		$("#LoginLink").prop("href", "../login.php");
	</script>
_END;

	die ("<p><span class='main'>You must <strong><a href='../login.php'>Log In</a></strong> to view this page!</span></p>");
}

echo "<span class='main'>Hi $user, you can enjoy playing these games for free.</span>";

?>

<!--
<!DOCTYPE html>
<html>
	<head>
		<title>Space Bowling</title>
		<meta charset = "utf-8">
		<link rel='stylesheet' href='../styles.css' type='text/css' />
	</head>
	<body>
-->
		<link rel='stylesheet' href='../styles.css' type='text/css'>
		<!-- DOES NOT WORK, even though it was OK in my home environement. <script type="text/javascript"> var user = "<?=$user ?>";</script> -->
		<script type="text/javascript"> var user = "<?php echo $user; ?>";</script>
		<script type="text/javascript" src="headerLinkMod.js"></script>

		<div class="main" id="gameIndex">
			<p class="error">On Internet Explorer, it is NOT possible to play these games so far, sorry...</p>

			<h4 class="gameTitle"><a href="SpaceBowling/SB_index.html">Space Bowling</a>: Try to remove all balls with less throws.</h4>

			<table class="gameTab" id="gameRankSB">
				<tr> <th>Rank</th><th>User</th><th>Score</th> </tr>

				<?php
					require_once '../functions.php';

					$r = 1;
					$result = queryMysql_L("SELECT * FROM gamescores WHERE game = 'SpaceBowling' ORDER BY score LIMIT 5");

					if ($result->num_rows)
					{
						while ($row = $result->fetch_array(MYSQLI_ASSOC))
						{
							echo "<tr><td>$r<td>" . $row['user'] . "</td><td>" . $row['score'] . "</td></tr>";
							$r++;
						}
					}
					else
					{
						echo "<h4>No ranking data yet</h4>";
					}
				?>

			</table>

			<h4 class="gameTitle"><a href="AsteroidAvoidance/AsteroidAvoidance_index.html">Asteroid Avoidance</a>: Try to avoid asteroids as long as possible.</h4>
			
			<table class="gameTab" id="gameRankSB">
				<tr> <th>Rank</th><th>User</th><th>Score</th> </tr>

				<?php
					require_once '../functions.php';

					$r = 1;
					$result = queryMysql_L("SELECT * FROM gamescores WHERE game = 'AsteroidAvoidance' ORDER BY score LIMIT 3");

					if ($result->num_rows)
					{
						while ($row = $result->fetch_array(MYSQLI_ASSOC))
						{
							echo "<tr><td>$r<td>" . $row['user'] . "</td><td>" . $row['score'] . "</td></tr>";
							$r++;
						}
					}
					else
					{
						echo "<h4>No ranking data yet</h4>";
					}
				?>

			</table>

		</div>
	</body>
</html>